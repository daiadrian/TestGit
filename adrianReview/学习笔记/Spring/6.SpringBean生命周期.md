![](.\images\springbean生命周期.png)

图文描述

- Bean容器找到配置文件中 Spring Bean 的定义

- Bean容器利用 反射API 创建一个Bean的实例

- 如果涉及到一些属性值利用set方法设置一些属性值：

  - 如果Bean实现了 `BeanNameAware` 接口，调用 `setBeanName()` 方法，传入Bean的名字。

  - 如果Bean实现了 `BeanClassLoaderAware` 接口，调用 `setBeanClassLoader()` 方法，传入`ClassLoader` 对象的实例。

  - 如果Bean实现了`BeanFactoryAware` 接口，调用 `setBeanFactory()` 方法

  - 与上面的类似，如果实现了其他*Aware接口，就调用相应的方法。

- 如果有和加载这个Bean的Spring容器相关的 `BeanPostProcessor` 对象，执行`postProcessBeforeInitialization()` 方法

- 如果Bean实现了 `InitializingBean` 接口，执行 `afterPropertiesSet()` 方法。

- 如果Bean在配置文件中的定义包含 `init-method` 属性，执行指定的方法。

- 如果有和加载这个Bean的Spring容器相关的 `BeanPostProcessor` 对象，执行`postProcessAfterInitialization()` 方法

- 当要销毁Bean的时候，如果Bean实现了 `DisposableBean` 接口，执行 `destroy()` 方法

- 当要销毁Bean的时候，如果Bean在配置文件中的定义包含 `destroy-method` 属性，执行指定的方法





简单描述

以BeanFactory为例，说明一个Bean的生命周期活动

- Bean的建立， 由 `BeanFactory` 读取Bean定义文件，并生成各个实例
- Setter注入，执行Bean的属性依赖注入
- `BeanNameAware` 的 `setBeanName()`, 如果实现该接口，则执行其 `setBeanName` 方法
- `BeanFactoryAware` 的 `setBeanFactory()` ，如果实现该接口，则执行其 `setBeanFactory` 方法
- `BeanPostProcessor` 的 `processBeforeInitialization()`，如果有关联的processor，则在Bean初始化之前都会执行这个实例的 `processBeforeInitialization()` 方法
- `InitializingBean` 的 `afterPropertiesSet()` ，如果实现了该接口，则执行其 `afterPropertiesSet()` 方法
- Bean定义文件中定义的 `init-method` 属性对应的方法（注解：`@PostConstruct`）
- `BeanPostProcessors` 的 `processAfterInitialization()`，如果有关联的processor，则在Bean初始化之前都会执行这个实例的 `processAfterInitialization()` 方法
- `DisposableBean` 的 `destroy()` ，在容器关闭时，如果Bean类实现了该接口，则执行它的 `destroy()` 方法
- Bean定义文件中定义 `destroy-method` （注解：`@PreDestroy`），在容器关闭时，可以在Bean定义文件中使用 `“destory-method”` 定义的方法

